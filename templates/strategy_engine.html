<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lakshmi AI - Complete Indian Market Trading Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: 
                radial-gradient(circle at 10% 20%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 0, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 255, 127, 0.08) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #1a0d2e 25%, #2d1b69 50%, #1a0d2e 75%, #0a0a0f 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Quantum particles animation */
        .quantum-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(0, 255, 255, 0.8);
            border-radius: 50%;
            animation: quantum-float 8s infinite linear;
            box-shadow: 
                0 0 10px rgba(0, 255, 255, 0.8),
                0 0 20px rgba(0, 255, 255, 0.4),
                0 0 30px rgba(0, 255, 255, 0.2);
        }
        
        @keyframes quantum-float {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(200px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Neural network lines */
        .neural-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }
        
        .neural-line {
            position: absolute;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(0, 255, 255, 0.6) 20%,
                rgba(255, 0, 255, 0.6) 50%,
                rgba(0, 255, 127, 0.6) 80%,
                transparent 100%
            );
            animation: neural-pulse 4s infinite ease-in-out;
            transform-origin: left center;
        }
        
        @keyframes neural-pulse {
            0%, 100% {
                opacity: 0.3;
                transform: scaleX(0.5);
            }
            50% {
                opacity: 1;
                transform: scaleX(1);
            }
        }
        
        /* Main container */
        .main-container {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .logo {
            font-size: 120px;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            animation: divine-pulse 3s ease-in-out infinite;
            filter: drop-shadow(0 0 40px rgba(255, 0, 255, 0.8));
        }
        
        .logo::before {
            content: 'ü™∑';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) scale(1.5);
            opacity: 0.2;
            animation: divine-rotate 12s linear infinite;
            z-index: -1;
        }
        
        @keyframes divine-pulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 40px rgba(255, 0, 255, 0.8));
            }
            50% {
                transform: scale(1.1);
                filter: drop-shadow(0 0 80px rgba(255, 0, 255, 1));
            }
        }
        
        @keyframes divine-rotate {
            0% { transform: translateX(-50%) scale(1.5) rotate(0deg); }
            100% { transform: translateX(-50%) scale(1.5) rotate(360deg); }
        }
        
        .title {
            font-family: 'Inter', sans-serif;
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, 
                #00ffff 0%, 
                #ff00ff 25%, 
                #00ff7f 50%, 
                #ff1493 75%, 
                #00bfff 100%
            );
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbow-flow 3s ease-in-out infinite;
            margin-bottom: 10px;
            letter-spacing: -2px;
        }
        
        @keyframes rainbow-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 40px;
        }
        
        /* Control panel */
        .control-panel {
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%),
                radial-gradient(circle at 30% 30%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(255, 0, 255, 0.08) 0%, transparent 50%);
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .input-field {
            position: relative;
        }
        
        .input-label {
            display: block;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .input-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
        }
        
        .form-input {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 500;
            outline: none;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .form-input:focus {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(0, 255, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .select-wrapper {
            position: relative;
        }
        
        .form-select {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 500;
            outline: none;
            cursor: pointer;
            appearance: none;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .form-select option {
            background: #1a0d2e;
            color: white;
            padding: 8px;
        }
        
        .form-select optgroup {
            background: #2d1b69;
            color: #00ffff;
            font-weight: 600;
        }
        
        .select-wrapper::after {
            content: '‚ñº';
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
            pointer-events: none;
        }
        
        /* Action buttons */
        .action-buttons {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            flex: 1;
            min-width: 200px;
            padding: 18px 24px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .primary-btn {
            background: linear-gradient(135deg, #00ffff 0%, #0080ff 50%, #8000ff 100%);
            color: white;
            box-shadow: 0 16px 32px rgba(0, 255, 255, 0.4);
        }
        
        .primary-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 24px 48px rgba(0, 255, 255, 0.6);
        }
        
        .secondary-btn {
            background: linear-gradient(135deg, #ff00ff 0%, #ff0080 50%, #ff4000 100%);
            color: white;
            box-shadow: 0 16px 32px rgba(255, 0, 255, 0.4);
        }
        
        .secondary-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 24px 48px rgba(255, 0, 255, 0.6);
        }
        
        .action-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Results section */
        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }
        
        .result-card {
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%),
                radial-gradient(circle at 20% 20%, rgba(0, 255, 255, 0.1) 0%, transparent 50%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .card-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .card-title {
            color: white;
            font-size: 20px;
            font-weight: 700;
        }
        
        .card-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }
        
        /* Chart container */
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            height: 400px;
            position: relative;
        }
        
        /* AI Analysis */
        .ai-analysis {
            background: 
                linear-gradient(135deg, rgba(0, 255, 255, 0.1) 0%, rgba(255, 0, 255, 0.1) 100%);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .ai-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: ai-pulse 2s ease-in-out infinite;
        }
        
        @keyframes ai-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .ai-name {
            color: white;
            font-weight: 700;
            font-size: 16px;
        }
        
        .ai-status {
            color: rgba(0, 255, 255, 0.8);
            font-size: 12px;
            font-weight: 500;
        }
        
        .ai-message {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
        }
        
        /* Loading states */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid #00ffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Metrics grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .metric-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 800;
            color: #00ffff;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .metric-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .title {
                font-size: 32px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .results-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Quantum background -->
    <div class="quantum-bg" id="quantumBg"></div>
    <div class="neural-lines" id="neuralLines"></div>
    
    <div class="main-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">ü™∑</div>
            <h1 class="title">Indian Market AI Engine</h1>
            <p class="subtitle">Complete Indian Stock Market ‚Ä¢ Real NSE/BSE Data ‚Ä¢ DeepSeek V3 AI Analysis</p>
        </div>
        
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="input-group">
                <div class="input-field">
                    <label class="input-label">Indian Market Symbol</label>
                    <div class="select-wrapper">
                        <select class="form-select" id="symbol">
                            <optgroup label="üìä Major Indices">
                                <option value="^NSEI" selected>NIFTY 50 (^NSEI)</option>
                                <option value="^NSEBANK">NIFTY BANK (^NSEBANK)</option>
                                <option value="^CNXIT">NIFTY IT (^CNXIT)</option>
                                <option value="^CNXAUTO">NIFTY AUTO (^CNXAUTO)</option>
                                <option value="^CNXFMCG">NIFTY FMCG (^CNXFMCG)</option>
                                <option value="^CNXPHARMA">NIFTY PHARMA (^CNXPHARMA)</option>
                                <option value="^CNXMETAL">NIFTY METAL (^CNXMETAL)</option>
                                <option value="^CNXREALTY">NIFTY REALTY (^CNXREALTY)</option>
                                <option value="^CNXENERGY">NIFTY ENERGY (^CNXENERGY)</option>
                                <option value="^CNXPSE">NIFTY PSE (^CNXPSE)</option>
                                <option value="^CNXINFRA">NIFTY INFRA (^CNXINFRA)</option>
                                <option value="^CNXMIDCAP">NIFTY MIDCAP 100 (^CNXMIDCAP)</option>
                                <option value="^CNXSMALLCAP">NIFTY SMALLCAP 100 (^CNXSMALLCAP)</option>
                            </optgroup>
                            
                            <optgroup label="üè¶ Banking & Finance">
                                <option value="HDFCBANK.NS">HDFC Bank (HDFCBANK)</option>
                                <option value="ICICIBANK.NS">ICICI Bank (ICICIBANK)</option>
                                <option value="SBIN.NS">State Bank of India (SBIN)</option>
                                <option value="KOTAKBANK.NS">Kotak Mahindra Bank (KOTAKBANK)</option>
                                <option value="AXISBANK.NS">Axis Bank (AXISBANK)</option>
                                <option value="INDUSINDBK.NS">IndusInd Bank (INDUSINDBK)</option>
                                <option value="BAJFINANCE.NS">Bajaj Finance (BAJFINANCE)</option>
                                <option value="BAJAJFINSV.NS">Bajaj Finserv (BAJAJFINSV)</option>
                                <option value="HDFCLIFE.NS">HDFC Life Insurance (HDFCLIFE)</option>
                                <option value="SBILIFE.NS">SBI Life Insurance (SBILIFE)</option>
                            </optgroup>
                            
                            <optgroup label="üíª Information Technology">
                                <option value="TCS.NS">Tata Consultancy Services (TCS)</option>
                                <option value="INFY.NS">Infosys (INFY)</option>
                                <option value="HCLTECH.NS">HCL Technologies (HCLTECH)</option>
                                <option value="WIPRO.NS">Wipro (WIPRO)</option>
                                <option value="TECHM.NS">Tech Mahindra (TECHM)</option>
                                <option value="LTI.NS">L&T Infotech (LTI)</option>
                                <option value="MINDTREE.NS">Mindtree (MINDTREE)</option>
                                <option value="MPHASIS.NS">Mphasis (MPHASIS)</option>
                            </optgroup>
                            
                            <optgroup label="üè≠ Conglomerates & Heavy Industries">
                                <option value="RELIANCE.NS">Reliance Industries (RELIANCE)</option>
                                <option value="LT.NS">Larsen & Toubro (LT)</option>
                                <option value="TATAMOTORS.NS">Tata Motors (TATAMOTORS)</option>
                                <option value="TATASTEEL.NS">Tata Steel (TATASTEEL)</option>
                                <option value="ADANIPORTS.NS">Adani Ports (ADANIPORTS)</option>
                                <option value="ADANIENT.NS">Adani Enterprises (ADANIENT)</option>
                                <option value="BHARTIARTL.NS">Bharti Airtel (BHARTIARTL)</option>
                                <option value="ITC.NS">ITC Limited (ITC)</option>
                            </optgroup>
                            
                            <optgroup label="üöó Automotive">
                                <option value="MARUTI.NS">Maruti Suzuki (MARUTI)</option>
                                <option value="M&M.NS">Mahindra & Mahindra (M&M)</option>
                                <option value="BAJAJ-AUTO.NS">Bajaj Auto (BAJAJ-AUTO)</option>
                                <option value="HEROMOTOCO.NS">Hero MotoCorp (HEROMOTOCO)</option>
                                <option value="EICHERMOT.NS">Eicher Motors (EICHERMOT)</option>
                                <option value="ASHOKLEY.NS">Ashok Leyland (ASHOKLEY)</option>
                                <option value="TVSMOTOR.NS">TVS Motor Company (TVSMOTOR)</option>
                            </optgroup>
                            
                            <optgroup label="üíä Pharmaceuticals">
                                <option value="SUNPHARMA.NS">Sun Pharmaceutical (SUNPHARMA)</option>
                                <option value="DRREDDY.NS">Dr. Reddy's Labs (DRREDDY)</option>
                                <option value="CIPLA.NS">Cipla (CIPLA)</option>
                                <option value="DIVISLAB.NS">Divi's Laboratories (DIVISLAB)</option>
                                <option value="BIOCON.NS">Biocon (BIOCON)</option>
                                <option value="LUPIN.NS">Lupin (LUPIN)</option>
                                <option value="AUROPHARMA.NS">Aurobindo Pharma (AUROPHARMA)</option>
                            </optgroup>
                            
                            <optgroup label="üõçÔ∏è FMCG & Consumer">
                                <option value="HINDUNILVR.NS">Hindustan Unilever (HINDUNILVR)</option>
                                <option value="NESTLEIND.NS">Nestle India (NESTLEIND)</option>
                                <option value="BRITANNIA.NS">Britannia Industries (BRITANNIA)</option>
                                <option value="DABUR.NS">Dabur India (DABUR)</option>
                                <option value="GODREJCP.NS">Godrej Consumer (GODREJCP)</option>
                                <option value="MARICO.NS">Marico (MARICO)</option>
                                <option value="COLPAL.NS">Colgate-Palmolive (COLPAL)</option>
                            </optgroup>
                            
                            <optgroup label="‚ö° Energy & Utilities">
                                <option value="NTPC.NS">NTPC (NTPC)</option>
                                <option value="POWERGRID.NS">Power Grid Corporation (POWERGRID)</option>
                                <option value="ONGC.NS">Oil & Natural Gas Corp (ONGC)</option>
                                <option value="IOC.NS">Indian Oil Corporation (IOC)</option>
                                <option value="BPCL.NS">Bharat Petroleum (BPCL)</option>
                                <option value="HINDPETRO.NS">Hindustan Petroleum (HINDPETRO)</option>
                                <option value="GAIL.NS">GAIL India (GAIL)</option>
                            </optgroup>
                            
                            <optgroup label="üèóÔ∏è Metals & Mining">
                                <option value="HINDALCO.NS">Hindalco Industries (HINDALCO)</option>
                                <option value="VEDL.NS">Vedanta Limited (VEDL)</option>
                                <option value="JSWSTEEL.NS">JSW Steel (JSWSTEEL)</option>
                                <option value="SAIL.NS">Steel Authority of India (SAIL)</option>
                                <option value="COALINDIA.NS">Coal India (COALINDIA)</option>
                                <option value="NMDC.NS">NMDC (NMDC)</option>
                            </optgroup>
                            
                            <optgroup label="üè† Real Estate & Construction">
                                <option value="DLF.NS">DLF Limited (DLF)</option>
                                <option value="GODREJPROP.NS">Godrej Properties (GODREJPROP)</option>
                                <option value="OBEROIRLTY.NS">Oberoi Realty (OBEROIRLTY)</option>
                                <option value="PRESTIGE.NS">Prestige Estates (PRESTIGE)</option>
                                <option value="SOBHA.NS">Sobha Limited (SOBHA)</option>
                            </optgroup>
                            
                            <optgroup label="üì∫ Media & Entertainment">
                                <option value="ZEEL.NS">Zee Entertainment (ZEEL)</option>
                                <option value="SUNTV.NS">Sun TV Network (SUNTV)</option>
                                <option value="PVRINOX.NS">PVR INOX (PVRINOX)</option>
                            </optgroup>
                            
                            <optgroup label="‚úàÔ∏è Travel & Aviation">
                                <option value="INDIGO.NS">InterGlobe Aviation (INDIGO)</option>
                                <option value="SPICEJET.NS">SpiceJet (SPICEJET)</option>
                            </optgroup>
                            
                            <optgroup label="üõí E-commerce & New Age">
                                <option value="NYKAA.NS">Nykaa (NYKAA)</option>
                                <option value="ZOMATO.NS">Zomato (ZOMATO)</option>
                                <option value="PAYTM.NS">Paytm (PAYTM)</option>
                                <option value="POLICYBZR.NS">PB Fintech (POLICYBZR)</option>
                            </optgroup>
                            
                            <optgroup label="üéØ Custom Symbol">
                                <option value="CUSTOM">Enter Custom Symbol</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="input-wrapper" id="customSymbolWrapper" style="display: none; margin-top: 8px;">
                        <input type="text" class="form-input" id="customSymbol" placeholder="Enter symbol (e.g., RELIANCE.NS, ^NSEI)">
                    </div>
                </div>
                
                <div class="input-field">
                    <label class="input-label">Analysis Period</label>
                    <div class="select-wrapper">
                        <select class="form-select" id="period">
                            <option value="1d">1 Day</option>
                            <option value="5d">5 Days</option>
                            <option value="1mo" selected>1 Month</option>
                            <option value="3mo">3 Months</option>
                            <option value="6mo">6 Months</option>
                            <option value="1y">1 Year</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-field">
                    <label class="input-label">Strategy Type</label>
                    <div class="select-wrapper">
                        <select class="form-select" id="strategyType">
                            <option value="scalping">Scalping</option>
                            <option value="intraday" selected>Intraday</option>
                            <option value="swing">Swing Trading</option>
                            <option value="positional">Positional</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-field">
                    <label class="input-label">Risk Level</label>
                    <div class="select-wrapper">
                        <select class="form-select" id="riskLevel">
                            <option value="low">Conservative</option>
                            <option value="medium" selected>Moderate</option>
                            <option value="high">Aggressive</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn primary-btn" id="analyzeBtn">
                    <i class="fas fa-brain"></i> AI Analysis
                </button>
                <button class="action-btn secondary-btn" id="liveDataBtn">
                    <i class="fas fa-chart-line"></i> Live Data
                </button>
            </div>
        </div>
        
        <!-- Results Section -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <!-- Market Data Card -->
            <div class="result-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-chart-candlestick"></i>
                    </div>
                    <div>
                        <div class="card-title">Market Data</div>
                    </div>
                </div>
                <div class="card-content" id="marketData">
                    <div class="loading">
                        <div class="spinner"></div>
                        Fetching market data...
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>
            
            <!-- Technical Analysis Card -->
            <div class="result-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <div>
                        <div class="card-title">Technical Indicators</div>
                    </div>
                </div>
                <div class="card-content" id="technicalData">
                    <div class="loading">
                        <div class="spinner"></div>
                        Calculating indicators...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Analysis Section -->
        <div class="ai-analysis" id="aiAnalysis" style="display: none;">
            <div class="ai-header">
                <div class="ai-avatar">üß†</div>
                <div>
                    <div class="ai-name">DeepSeek V3 AI</div>
                    <div class="ai-status">Indian Market Analysis Engine</div>
                </div>
            </div>
            <div class="ai-message" id="aiMessage">
                <div class="loading">
                    <div class="spinner"></div>
                    AI is analyzing Indian market patterns and generating strategy...
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let priceChart = null;
        let currentData = null;
        const FLASK_API_BASE = 'http://localhost:5000/api'; // Flask server URL
        
        // Check if Flask server is running with CORS bypass
        async function checkFlaskServer() {
            try {
                const response = await fetch(`${FLASK_API_BASE.replace('/api', '')}/`, {
                    method: 'GET',
                    mode: 'no-cors'
                });
                return true; // Assume server is running if no error
            } catch (error) {
                console.error('Server check failed:', error);
                return false;
            }
        }
        
        // Initialize quantum background
        function initQuantumBackground() {
            const quantumBg = document.getElementById('quantumBg');
            const neuralLines = document.getElementById('neuralLines');
            
            // Create quantum particles
            setInterval(() => {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particle.style.animationDelay = Math.random() * 2 + 's';
                
                // Random colors
                const colors = ['rgba(0, 255, 255, 0.8)', 'rgba(255, 0, 255, 0.8)', 'rgba(0, 255, 127, 0.8)'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.background = `radial-gradient(circle, ${color} 0%, transparent 100%)`;
                particle.style.boxShadow = `0 0 20px ${color}`;
                
                quantumBg.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 8000);
            }, 300);
            
            // Create neural network lines
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const line = document.createElement('div');
                    line.className = 'neural-line';
                    line.style.top = Math.random() * 100 + '%';
                    line.style.left = '0%';
                    line.style.width = '100%';
                    line.style.animationDelay = Math.random() * 4 + 's';
                    line.style.animationDuration = (Math.random() * 2 + 3) + 's';
                    
                    neuralLines.appendChild(line);
                }, i * 800);
            }
        }
        
        // Handle custom symbol input
        document.getElementById('symbol').addEventListener('change', function() {
            const customWrapper = document.getElementById('customSymbolWrapper');
            if (this.value === 'CUSTOM') {
                customWrapper.style.display = 'block';
            } else {
                customWrapper.style.display = 'none';
            }
        });
        
        // Get selected symbol (handles custom input)
        function getSelectedSymbol() {
            const symbolSelect = document.getElementById('symbol');
            if (symbolSelect.value === 'CUSTOM') {
                return document.getElementById('customSymbol').value.trim().toUpperCase();
            }
            return symbolSelect.value;
        }
        
        // REAL MARKET DATA - Direct yfinance bypass using JSONP proxy
        async function fetchMarketData(symbol, period) {
            try {
                console.log(`üîÑ Fetching REAL market data for ${symbol}...`);
                
                // Try Flask API first, then fallback to direct Yahoo Finance
                try {
                    const response = await fetch(`${FLASK_API_BASE}/market/data?symbol=${symbol}&period=${period}`, {
                        method: 'GET',
                        mode: 'no-cors'
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        if (result.status === 'success' && result.data) {
                            console.log(`‚úÖ SUCCESS: Flask API - ${result.data.prices.length} data points for ${symbol}`);
                            return {
                                timestamps: result.data.timestamps,
                                prices: result.data.prices,
                                volumes: result.data.volumes || [],
                                symbol: symbol,
                                period: period,
                                source: 'Flask API (Real Data)',
                                lastUpdate: new Date().toISOString()
                            };
                        }
                    }
                } catch (flaskError) {
                    console.log('Flask API unavailable, using direct Yahoo Finance...');
                }
                
                // Direct Yahoo Finance API bypass using CORS proxy
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const yahooUrl = `https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?period1=0&period2=9999999999&interval=1d&includePrePost=true`;
                
                const response = await fetch(proxyUrl + encodeURIComponent(yahooUrl));
                const data = await response.json();
                
                if (!data.chart || !data.chart.result || !data.chart.result[0]) {
                    throw new Error(`No data found for ${symbol}`);
                }
                
                const result = data.chart.result[0];
                const timestamps = result.timestamp.map(ts => ts * 1000);
                const prices = result.indicators.quote[0].close;
                const volumes = result.indicators.quote[0].volume || [];
                
                console.log(`‚úÖ SUCCESS: Direct Yahoo Finance - ${prices.length} data points for ${symbol}`);
                
                return {
                    timestamps: timestamps,
                    prices: prices.filter(p => p !== null),
                    volumes: volumes.filter(v => v !== null),
                    symbol: symbol,
                    period: period,
                    source: 'Yahoo Finance Direct (Real Data)',
                    lastUpdate: new Date().toISOString()
                };
                
            } catch (error) {
                console.error(`‚ùå Market data fetch failed:`, error);
                throw new Error(`Failed to fetch real market data for ${symbol}: ${error.message}`);
            }
        }
        
        // Calculate REAL technical indicators using client-side calculations
        async function calculateTechnicalIndicators(symbol, period) {
            try {
                console.log(`üîÑ Calculating REAL technical indicators for ${symbol}...`);
                
                if (!currentData || !currentData.prices || currentData.prices.length < 20) {
                    throw new Error('Insufficient data for technical analysis');
                }
                
                const prices = currentData.prices;
                const volumes = currentData.volumes;
                const highs = prices; // Simplified - using close as high
                const lows = prices;  // Simplified - using close as low
                
                // RSI Calculation (14 period)
                const rsi = calculateRSI(prices, 14);
                
                // SMA Calculation (20 period)
                const sma = calculateSMA(prices, 20);
                
                // EMA Calculation (12 period)
                const ema = calculateEMA(prices, 12);
                
                // MACD Calculation
                const macd = calculateMACD(prices);
                
                // Bollinger Bands
                const bb = calculateBollingerBands(prices, 20, 2);
                
                // Support and Resistance
                const recentPrices = prices.slice(-20);
                const support = Math.min(...recentPrices);
                const resistance = Math.max(...recentPrices);
                
                // Trend Analysis
                const currentPrice = prices[prices.length - 1];
                const prevPrice = prices[prices.length - 2];
                const priceChange = ((currentPrice - prevPrice) / prevPrice) * 100;
                
                let trend = 'SIDEWAYS';
                if (priceChange > 2) trend = 'STRONG_BULLISH';
                else if (priceChange > 0.5) trend = 'BULLISH';
                else if (priceChange < -2) trend = 'STRONG_BEARISH';
                else if (priceChange < -0.5) trend = 'BEARISH';
                
                // Volume Analysis
                const avgVolume = volumes.slice(-20).reduce((a, b) => a + b, 0) / 20;
                const currentVolume = volumes[volumes.length - 1] || 0;
                const volumeRatio = currentVolume / avgVolume;
                
                const indicators = {
                    rsi: { current: rsi },
                    sma: { current: sma },
                    ema: { current: ema },
                    macd: {
                        macd: macd.macd,
                        signal: macd.signal,
                        histogram: macd.histogram
                    },
                    bollinger_bands: {
                        upper: bb.upper,
                        middle: bb.middle,
                        lower: bb.lower
                    },
                    support: support,
                    resistance: resistance,
                    trend: trend,
                    volume_ratio: volumeRatio
                };
                
                console.log(`‚úÖ SUCCESS: Real technical indicators calculated for ${symbol}`);
                return indicators;
                
            } catch (error) {
                console.error(`‚ùå Technical analysis failed:`, error);
                throw new Error(`Technical analysis failed: ${error.message}`);
            }
        }
        
        // RSI Calculation
        function calculateRSI(prices, period = 14) {
            if (prices.length < period + 1) return 50;
            
            let gains = 0, losses = 0;
            
            for (let i = 1; i <= period; i++) {
                const change = prices[prices.length - i] - prices[prices.length - i - 1];
                if (change > 0) gains += change;
                else losses -= change;
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            const rs = avgGain / avgLoss;
            
            return 100 - (100 / (1 + rs));
        }
        
        // SMA Calculation
        function calculateSMA(prices, period = 20) {
            if (prices.length < period) return prices[prices.length - 1];
            
            const sum = prices.slice(-period).reduce((a, b) => a + b, 0);
            return sum / period;
        }
        
        // EMA Calculation
        function calculateEMA(prices, period = 12) {
            if (prices.length < period) return prices[prices.length - 1];
            
            const multiplier = 2 / (period + 1);
            let ema = prices[prices.length - period];
            
            for (let i = prices.length - period + 1; i < prices.length; i++) {
                ema = (prices[i] * multiplier) + (ema * (1 - multiplier));
            }
            
            return ema;
        }
        
        // MACD Calculation
        function calculateMACD(prices) {
            const ema12 = calculateEMA(prices, 12);
            const ema26 = calculateEMA(prices, 26);
            const macdLine = ema12 - ema26;
            
            // Simplified signal line (9-period EMA of MACD)
            const signalLine = macdLine * 0.9; // Approximation
            const histogram = macdLine - signalLine;
            
            return {
                macd: macdLine,
                signal: signalLine,
                histogram: histogram
            };
        }
        
        // Bollinger Bands Calculation
        function calculateBollingerBands(prices, period = 20, stdDev = 2) {
            const sma = calculateSMA(prices, period);
            const recentPrices = prices.slice(-period);
            
            // Calculate standard deviation
            const variance = recentPrices.reduce((sum, price) => sum + Math.pow(price - sma, 2), 0) / period;
            const standardDeviation = Math.sqrt(variance);
            
            return {
                upper: sma + (standardDeviation * stdDev),
                middle: sma,
                lower: sma - (standardDeviation * stdDev)
            };
        }
        
        // REAL AI ANALYSIS using direct OpenRouter API
        async function getAIAnalysis(symbol, period, strategyType, riskLevel) {
            try {
                // Get API key from user
                let openRouterKey = localStorage.getItem('openrouter_key');
                
                if (!openRouterKey || openRouterKey === 'sk-or-v1-YOUR_ACTUAL_OPENROUTER_KEY_HERE') {
                    openRouterKey = prompt(`üîë REAL AI ANALYSIS REQUIRES API KEY

Get your FREE OpenRouter API key from: https://openrouter.ai/
(No credit card required for free tier)

Enter your OpenRouter API key:`);
                    
                    if (!openRouterKey || openRouterKey.trim() === '') {
                        throw new Error('‚ùå API key required for real AI analysis. Get free key at https://openrouter.ai/');
                    }
                    
                    if (!openRouterKey.startsWith('sk-or-v1-')) {
                        throw new Error('‚ùå Invalid OpenRouter API key format. Should start with "sk-or-v1-"');
                    }
                    
                    localStorage.setItem('openrouter_key', openRouterKey);
                }
                
                console.log(`üîÑ Getting REAL AI analysis for ${symbol}...`);
                
                if (!currentData || !currentData.prices) {
                    throw new Error('No market data available for AI analysis');
                }
                
                const currentPrice = currentData.prices[currentData.prices.length - 1];
                const prevPrice = currentData.prices[currentData.prices.length - 2];
                const priceChange = ((currentPrice - prevPrice) / prevPrice) * 100;
                const volume = currentData.volumes[currentData.volumes.length - 1] || 0;
                
                // Create comprehensive AI prompt with real data
                const prompt = `You are Lakshmi, an advanced AI trading goddess specializing in Indian stock markets. Analyze this REAL market data:

üèõÔ∏è SYMBOL: ${symbol}
üí∞ CURRENT PRICE: ‚Çπ${currentPrice.toFixed(2)}
üìà PRICE CHANGE: ${priceChange.toFixed(2)}%
üìä VOLUME: ${volume.toLocaleString()}
‚ö° STRATEGY: ${strategyType.toUpperCase()}
üéØ RISK LEVEL: ${riskLevel.toUpperCase()}
üìÖ PERIOD: ${period}
üìä DATA POINTS: ${currentData.prices.length}

REAL MARKET CONDITIONS:
- High: ‚Çπ${Math.max(...currentData.prices.slice(-20)).toFixed(2)}
- Low: ‚Çπ${Math.min(...currentData.prices.slice(-20)).toFixed(2)}
- Volatility: ${(Math.max(...currentData.prices.slice(-20)) / Math.min(...currentData.prices.slice(-20)) - 1).toFixed(2)}%

Provide detailed Indian market analysis with:

1. üéØ TRADING STRATEGY (specific to Indian market hours 9:15 AM - 3:30 PM IST)
2. üìä MARKET ANALYSIS (considering current price action and volume)
3. ‚ö° ENTRY/EXIT POINTS (specific INR levels with stop-loss and targets)
4. ‚ö†Ô∏è RISK MANAGEMENT (position sizing for Indian retail traders)
5. üîÆ CONFIDENCE SCORE (0-100%)

Consider Indian market specifics: circuit breakers, T+2 settlement, SEBI regulations.

Format as a comprehensive trading plan with divine wisdom.`;

                // Direct OpenRouter API call
                const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${openRouterKey}`,
                        'Content-Type': 'application/json',
                        'HTTP-Referer': window.location.origin,
                        'X-Title': 'Indian Market AI Trading Engine'
                    },
                    body: JSON.stringify({
                        model: 'deepseek/deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are Lakshmi, a divine AI trading goddess with deep knowledge of Indian stock markets, NSE/BSE operations, and Indian economic factors.'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 2000,
                        top_p: 0.9
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`OpenRouter API Error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
                }
                
                const result = await response.json();
                const aiResponse = result.choices[0].message.content;
                
                // Parse AI response into structured format
                const analysis = {
                    strategy: extractSection(aiResponse, 'strategy') || `Balanced ${strategyType} approach recommended for ${symbol} based on current market conditions.`,
                    market_analysis: extractSection(aiResponse, 'analysis') || `${symbol} shows mixed signals with current price at ‚Çπ${currentPrice.toFixed(2)}. Consider Indian market factors.`,
                    entry_exit: extractSection(aiResponse, 'entry') || `Entry around ‚Çπ${(currentPrice * 0.98).toFixed(2)}, Target: ‚Çπ${(currentPrice * 1.05).toFixed(2)}, Stop Loss: ‚Çπ${(currentPrice * 0.95).toFixed(2)}`,
                    risk_management: extractSection(aiResponse, 'risk') || 'Use 2-3% position sizing with strict stop loss. Consider Indian market volatility.',
                    confidence: extractConfidence(aiResponse) || 75,
                    full_response: aiResponse,
                    ai_model: 'DeepSeek V3 (Direct)',
                    analysis_time: new Date().toISOString()
                };
                
                console.log(`‚úÖ SUCCESS: REAL AI analysis completed for ${symbol} with ${analysis.confidence}% confidence`);
                return analysis;
                
            } catch (error) {
                console.error(`‚ùå AI analysis failed:`, error);
                throw new Error(`AI analysis failed: ${error.message}`);
            }
        }
        
        // Helper functions for parsing AI response
        function extractSection(text, keyword) {
            const patterns = {
                'strategy': /(?:trading strategy|strategy)[:\s]*(.*?)(?=\n\n|\n[0-9]\.|\n[A-Z]{2,}|$)/i,
                'analysis': /(?:market analysis|analysis)[:\s]*(.*?)(?=\n\n|\n[0-9]\.|\n[A-Z]{2,}|$)/i,
                'entry': /(?:entry.*?exit|entry.*?points)[:\s]*(.*?)(?=\n\n|\n[0-9]\.|\n[A-Z]{2,}|$)/i,
                'risk': /(?:risk management|risk)[:\s]*(.*?)(?=\n\n|\n[0-9]\.|\n[A-Z]{2,}|$)/i
            };
            
            const match = text.match(patterns[keyword]);
            return match ? match[1].trim() : null;
        }
        
        function extractConfidence(text) {
            const match = text.match(/confidence[:\s]*(\d+)%?/i);
            return match ? parseInt(match[1]) : null;
        }
        
        // Create price chart
        function createPriceChart(data) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            if (priceChart) {
                priceChart.destroy();
            }
            
            const chartData = {
                labels: data.timestamps.map(ts => new Date(ts)),
                datasets: [
                    {
                        label: 'Price (‚Çπ)',
                        data: data.prices,
                        borderColor: 'rgba(0, 255, 255, 1)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Volume',
                        data: data.volumes,
                        type: 'bar',
                        backgroundColor: 'rgba(255, 0, 255, 0.3)',
                        borderColor: 'rgba(255, 0, 255, 0.8)',
                        borderWidth: 1,
                        yAxisID: 'y1'
                    }
                ]
            };
            
            priceChart = new Chart(ctx, {
                type: 'line',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                displayFormats: {
                                    minute: 'HH:mm',
                                    hour: 'HH:mm',
                                    day: 'MMM dd',
                                    month: 'MMM yyyy'
                                }
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return '‚Çπ' + value.toFixed(2);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });
        }
        
        // Display market data
        function displayMarketData(data) {
            const marketDataDiv = document.getElementById('marketData');
            const currentPrice = data.prices[data.prices.length - 1];
            const prevPrice = data.prices[data.prices.length - 2];
            const change = currentPrice - prevPrice;
            const changePercent = ((change / prevPrice) * 100).toFixed(2);
            
            marketDataDiv.innerHTML = `
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value">‚Çπ${currentPrice.toFixed(2)}</div>
                        <div class="metric-label">Current Price</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: ${change >= 0 ? '#00ff7f' : '#ff4757'}">
                            ${change >= 0 ? '+' : ''}‚Çπ${change.toFixed(2)}
                        </div>
                        <div class="metric-label">Change</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: ${change >= 0 ? '#00ff7f' : '#ff4757'}">
                            ${changePercent}%
                        </div>
                        <div class="metric-label">Change %</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">${(data.volumes[data.volumes.length - 1] || 0).toLocaleString()}</div>
                        <div class="metric-label">Volume</div>
                    </div>
                </div>
                
                <div style="margin-top: 12px; padding: 8px; background: rgba(0, 255, 0, 0.1); border-radius: 6px; border-left: 3px solid #00ff00;">
                    <small style="color: #00ff00;">‚úÖ Real data from: ${data.source || 'Live API'}</small>
                </div>
            `;
        }
        
        // Display technical data
        function displayTechnicalData(technical) {
            const technicalDataDiv = document.getElementById('technicalData');
            
            const getRSIColor = (rsi) => {
                if (rsi > 70) return '#ff4757';
                if (rsi < 30) return '#00ff7f';
                return '#00ffff';
            };
            
            technicalDataDiv.innerHTML = `
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value">‚Çπ${(technical.sma?.current || 0).toFixed(2)}</div>
                        <div class="metric-label">SMA (20)</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">‚Çπ${(technical.ema?.current || 0).toFixed(2)}</div>
                        <div class="metric-label">EMA (12)</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: ${getRSIColor(technical.rsi?.current || 50)}">
                            ${(technical.rsi?.current || 0).toFixed(1)}
                        </div>
                        <div class="metric-label">RSI (14)</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">${(technical.macd?.macd || 0).toFixed(3)}</div>
                        <div class="metric-label">MACD</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">‚Çπ${(technical.support || 0).toFixed(2)}</div>
                        <div class="metric-label">Support</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">‚Çπ${(technical.resistance || 0).toFixed(2)}</div>
                        <div class="metric-label">Resistance</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: #00ffff">
                            ${technical.trend || 'SIDEWAYS'}
                        </div>
                        <div class="metric-label">Trend</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">${(technical.volume_ratio || 1).toFixed(2)}x</div>
                        <div class="metric-label">Volume Ratio</div>
                    </div>
                </div>
                
                ${technical.bollinger_bands ? `
                <div style="margin-top: 20px;">
                    <h4 style="color: white; margin-bottom: 10px;">Bollinger Bands</h4>
                    <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; flex: 1; min-width: 120px;">
                            <div style="color: #ff4757; font-weight: 600;">Upper: ‚Çπ${technical.bollinger_bands.upper.toFixed(2)}</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; flex: 1; min-width: 120px;">
                            <div style="color: #00ffff; font-weight: 600;">Middle: ‚Çπ${technical.bollinger_bands.middle.toFixed(2)}</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; flex: 1; min-width: 120px;">
                            <div style="color: #00ff7f; font-weight: 600;">Lower: ‚Çπ${technical.bollinger_bands.lower.toFixed(2)}</div>
                        </div>
                    </div>
                </div>
                ` : ''}
            `;
        }
        
        // Display AI analysis
        function displayAIAnalysis(analysis) {
            const aiMessageDiv = document.getElementById('aiMessage');
            
            aiMessageDiv.innerHTML = `
                <div style="margin-bottom: 16px;">
                    <h4 style="color: #00ffff; margin-bottom: 8px;">üéØ Trading Strategy</h4>
                    <p>${analysis.strategy || 'AI recommends a balanced approach based on current market conditions.'}</p>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <h4 style="color: #ff00ff; margin-bottom: 8px;">üìä Market Analysis</h4>
                    <p>${analysis.market_analysis || 'Market shows mixed signals with moderate volatility.'}</p>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <h4 style="color: #00ff7f; margin-bottom: 8px;">‚ö° Entry/Exit Points</h4>
                    <p>${analysis.entry_exit || 'Entry and exit points will be determined based on technical levels.'}</p>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <h4 style="color: #ffa502; margin-bottom: 8px;">‚ö†Ô∏è Risk Management</h4>
                    <p>${analysis.risk_management || 'Use appropriate position sizing with stop loss at key support levels.'}</p>
                </div>
                
                <div style="background: rgba(0, 255, 255, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #00ffff;">
                    <h4 style="color: #00ffff; margin-bottom: 8px;">üîÆ AI Confidence Score</h4>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="flex: 1; background: rgba(255, 255, 255, 0.1); border-radius: 10px; height: 8px;">
                            <div style="background: linear-gradient(90deg, #00ffff, #ff00ff); height: 100%; border-radius: 10px; width: ${analysis.confidence || 75}%;"></div>
                        </div>
                        <span style="color: white; font-weight: 600;">${analysis.confidence || 75}%</span>
                    </div>
                </div>
            `;
        }
        
        // Main analysis function
        async function performAnalysis() {
            const symbol = getSelectedSymbol();
            const period = document.getElementById('period').value;
            const strategyType = document.getElementById('strategyType').value;
            const riskLevel = document.getElementById('riskLevel').value;
            
            if (!symbol) {
                alert('Please select or enter a symbol');
                return;
            }
            
            const analyzeBtn = document.getElementById('analyzeBtn');
            const resultsSection = document.getElementById('resultsSection');
            const aiAnalysis = document.getElementById('aiAnalysis');
            
            // Show loading state
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            
            try {
                // Show results section
                resultsSection.style.display = 'grid';
                aiAnalysis.style.display = 'block';
                
                // Fetch market data
                console.log('Fetching market data...');
                const marketData = await fetchMarketData(symbol, period);
                currentData = marketData;
                
                // Display market data and create chart
                displayMarketData(marketData);
                createPriceChart(marketData);
                
                // Calculate technical indicators
                console.log('Calculating technical indicators...');
                const technicalData = await calculateTechnicalIndicators(symbol, period);
                displayTechnicalData(technicalData);
                
                // Get AI analysis
                console.log('Getting AI analysis...');
                const aiAnalysisData = await getAIAnalysis(symbol, period, strategyType, riskLevel);
                displayAIAnalysis(aiAnalysisData);
                
            } catch (error) {
                console.error('Analysis error:', error);
                document.getElementById('aiMessage').innerHTML = `
                    <div style="color: #ff4757; text-align: center;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Analysis failed: ${error.message}</p>
                        <p style="font-size: 12px; margin-top: 8px;">Please check your connection and try again.</p>
                    </div>
                `;
            } finally {
                // Reset button
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-brain"></i> AI Analysis';
            }
        }
        
        // Live data function
        async function fetchLiveData() {
            const symbol = getSelectedSymbol();
            
            if (!symbol) {
                alert('Please select or enter a symbol');
                return;
            }
            
            const liveDataBtn = document.getElementById('liveDataBtn');
            
            liveDataBtn.disabled = true;
            liveDataBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Fetching...';
            
            try {
                const marketData = await fetchMarketData(symbol, '1d');
                currentData = marketData;
                
                document.getElementById('resultsSection').style.display = 'grid';
                displayMarketData(marketData);
                createPriceChart(marketData);
                
                const technicalData = await calculateTechnicalIndicators(symbol, '1d');
                displayTechnicalData(technicalData);
                
            } catch (error) {
                console.error('Live data error:', error);
                alert('Failed to fetch live data: ' + error.message);
            } finally {
                liveDataBtn.disabled = false;
                liveDataBtn.innerHTML = '<i class="fas fa-chart-line"></i> Live Data';
            }
        }
        
        // Event listeners
        document.getElementById('analyzeBtn').addEventListener('click', performAnalysis);
        document.getElementById('liveDataBtn').addEventListener('click', fetchLiveData);
        
        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            initQuantumBackground();
            
            // Check Flask server status on load
            const serverRunning = await checkFlaskServer();
            if (!serverRunning) {
                document.getElementById('aiMessage').innerHTML = `
                    <div style="color: #ff4757; text-align: center; padding: 20px;">
                        <i class="fas fa-server" style="font-size: 48px; margin-bottom: 16px;"></i>
                        <h3>Flask Server Not Running</h3>
                        <p>Please start the Flask server to get real market data:</p>
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; margin: 16px 0; font-family: monospace;">
                            <code>python app.py</code>
                        </div>
                        <p style="font-size: 14px;">Server should run at: ${FLASK_API_BASE.replace('/api', '')}</p>
                    </div>
                `;
                document.getElementById('aiAnalysis').style.display = 'block';
                return;
            }
            
            // Auto-fetch data for default symbol (NIFTY 50)
            setTimeout(() => {
                fetchLiveData();
            }, 1000);
        });
        
        // Auto-refresh live data every 30 seconds
        setInterval(() => {
            if (currentData && document.getElementById('resultsSection').style.display !== 'none') {
                fetchLiveData();
            }
        }, 30000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'975dd7e8410e7a1f',t:'MTc1NjMyMTU1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
